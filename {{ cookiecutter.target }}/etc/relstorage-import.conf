{% import 'db.conf' as db with context
%}{%- set db_blob_mode = cookiecutter.db_blobs_mode or cookiecutter.db_blob_mode%}
{%- set db_blob_location = cookiecutter.db_blobs_location or cookiecutter.db_blob_location
%}## Configuration file to import a Filestorage database into a RelStorage database.
# It is meant to be used with the zobdconvert command line utility from RelStorage.
# zodbconvert is installed in the same virtual environment as the Plone site.
# For more information consult https://relstorage.readthedocs.io/en/latest/zodbconvert.html#how-to-use-zodbconvert

{%- if cookiecutter.db_storage == "relstorage" and cookiecutter.db_relstorage_import_filestorage_location and cookiecutter.db_relstorage_import_blobs_location%}

<filestorage source>
    path {{ cookiecutter.db_relstorage_import_filestorage_location | abspath }}
    blob-dir  {{ cookiecutter.db_relstorage_import_blobs_location | abspath }}
</filestorage>

{{ db.relstorage(
    db_blob_mode,
    db_blob_location,
    cookiecutter.db_blob_cache_size,
    cookiecutter.db_blob_cache_size_check,
    cookiecutter.db_relstorage_keep_history,
    cookiecutter.db_relstorage_read_only,
    cookiecutter.db_relstorage_create_schema,
    cookiecutter.db_relstorage_commit_lock_timeout,
    cookiecutter.db_relstorage_blob_cache_size_check_external,
    cookiecutter.db_relstorage_blob_chunk_size,
    cookiecutter.db_relstorage_cache_local_mb,
    cookiecutter.db_relstorage_cache_local_object_max,
    cookiecutter.db_relstorage_cache_local_compression,
    cookiecutter.db_relstorage_cache_local_dir,
    cookiecutter.db_relstorage_cache_prefix,
    cookiecutter.db_relstorage_replica_conf,
    cookiecutter.db_relstorage_ro_replica_conf,
    cookiecutter.db_relstorage_replica_timeout,
    cookiecutter.db_relstorage_replica_revert_when_stale,
    cookiecutter.db_relstorage,
    cookiecutter.db_relstorage_postgresql_driver,
    cookiecutter.db_relstorage_postgresql_dsn,
    cookiecutter.db_relstorage_mysql_driver,
    cookiecutter.db_relstorage_mysql_parameters,
    cookiecutter.db_relstorage_oracle_driver,
    cookiecutter.db_relstorage_commit_lock_id,
    cookiecutter.db_relstorage_oracle_user,
    cookiecutter.db_relstorage_oracle_password,
    cookiecutter.db_relstorage_oracle_dsn,
    cookiecutter.db_relstorage_sqlite3_driver,
    cookiecutter.db_relstorage_sqlite3_data_dir,
    cookiecutter.db_relstorage_sqlite3_gevent_yield_interval,
    cookiecutter.db_relstorage_sqlite3_pragma,
    " destination"
) }}

{% else %}
# !!! Missing db_relstorage_export_* settings!
{%- endif %}

# This file is generated by cookiecutter-zope-instance {{ cookiecutter._version }}.
# for details follow https://github.com/plone/cookiecutter-zope-instance
