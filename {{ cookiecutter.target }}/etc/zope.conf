# This file was generated by "cookiecutter-zope-instance"
%define INSTANCEHOME ABSPATH({{ cookiecutter.target }})
instancehome $INSTANCEHOME
%define CLIENTHOME ABSPATH({{ cookiecutter.var_location }})
clienthome $CLIENTHOME

debug-mode {{ cookiecutter.debug_mode }}
security-policy-implementation {{ "Python" if cookiecutter.verbose_security == "on" else "C"}}
verbose-security {{ cookiecutter.verbose_security }}

default-zpublisher-encoding utf-8

<environment>
{%- for key, value in cookiecutter.environment|dictsort %}
    {{ key }} {{ value }}
{%- endfor %}
</environment>

{%- if cookiecutter.database == "direct" %}
# Direct filestorage
<zodb_db main>
    mount-point /
    cache-size {{ cookiecutter.database_cache_size }}
{%- if cookiecutter.database_cache_size_bytes %}
    cache-size-bytes {{ cookiecutter.database_cache_size_byes }}
{%- endif %}
    # Blob-enabled FileStorage database
    <blobstorage>
      blob-dir ABSPATH({{ cookiecutter.blobs_location }})
      # FileStorage database
      <filestorage>
        path ABSPATH({{ cookiecutter.filestorage_location}})
      </filestorage>
    </blobstorage>
</zodb_db>
{%- endif %}
{%- if cookiecutter.database == "relstorage" %}
# RelStorage
<zodb_db main>
    %import relstorage
    mount-point /
    cache-size {{ cookiecutter.database_cache_size }}
{%- if cookiecutter.database_cache_size_bytes %}
    cache-size-bytes {{ cookiecutter.database_cache_size_byes }}
{%- endif %}
    <relstorage>
        keep-history {{ "true" if cookiecutter.relstorage_keep_history == "on" else "false" }}
        shared-blob-dir {{ "true" if cookiecutter.blobs_mode == "shared" else "false" }}
        blob-dir ABSPATH({{ cookiecutter.blobs_location }})
{%- if cookiecutter.relstorage_cache_local_mb %}
        cache-local-mb {{ cookiecutter.relstorage_cache_local_mb }}
{%- endif %}
        <postgresql>
            dsn dbname='plone' host='db' user='plone' password='plone'
        </postgresql>
    </relstorage>
</zodb_db>
{%- endif %}
{%- if cookiecutter.database == "zeo" %}
# ZEO NOT YET IMPLEMETED IN COOKIECUTTER TEMPLATE
{%- endif %}
{%- if cookiecutter.repoze_profile == "on" %}
# REPOZE PROFILE NOT YET IMPLEMETED IN COOKIECUTTER TEMPLATE
{%- endif %}
{%- if cookiecutter.sentry == "on" %}
# SENTRY PROFILE NOT YET IMPLEMETED IN COOKIECUTTER TEMPLATE
{%- endif %}
